<div class="mat-elevation-z4 transaction-table">
	<table mat-table
		[dataSource]="dataSource"
		multiTemplateDataRows

	>
		<ng-container matColumnDef="amount">
			<th mat-header-cell

				*matHeaderCellDef> Částka
			</th>
			<td mat-cell
				*matCellDef="let row"> {{row.amount}} Kč
			</td>

		</ng-container>

		<ng-container matColumnDef="type">
			<th mat-header-cell

				*matHeaderCellDef> Typ
			</th>
			<td mat-cell
				*matCellDef="let row">
				<ng-container *ngIf="row.type === 'Payment'">Platba</ng-container>
				<ng-container *ngIf="row.type === 'Deposit'">Vklad</ng-container>
			</td>

		</ng-container>

		<ng-container matColumnDef="created">
			<th mat-header-cell

				*matHeaderCellDef> Vytvořeno
			</th>
			<td mat-cell
				*matCellDef="let row"> {{row.created | date: 'dd/MM/yyyy HH:mm'}} </td>
		</ng-container>

		<ng-container matColumnDef="expandedDetail">
			<td mat-cell
				*matCellDef="let row"
				[attr.colspan]="displayedColumns.length">
				<div class="element-detail"
					[@detailExpand]="row === expandedRow ? 'expanded' : 'collapsed'"
				>
					<div class="detail-content d-flex justify-content-start align-items-center w-100">
						<ng-container *ngIf="detailReady">
							<span>Uživatel: {{ usersMap[row.userId]?.name ?? '' }}</span>
							<div class="records">
								<div *ngFor="let record of transactionsMap[row.id]?.records">
									<ng-container *ngIf="goodsMap[record.goodsId]">
										<span>{{ goodsMap[record.goodsId].name }}</span>
										<span>{{ goodsMap[record.goodsId].price }} Kč</span>
									</ng-container>
								</div>
							</div>
						</ng-container>
					</div>
				</div>
			</td>
		</ng-container>

		<tr mat-header-row
			*matHeaderRowDef="displayedColumns"></tr>

		<tr mat-row
			*matRowDef="let row; columns: displayedColumns;"
			class="table-row"
			[class.expanded-row]="expandedRow === row"
			(click)="showDetail(row)"
		></tr>

		<tr mat-row
			*matRowDef="let row; columns: ['expandedDetail']"
			class="detail-row">
		</tr>
	</table>
	<mat-paginator [pageSizeOptions]="[5, 10, 15, 25, 100]"
		[pageSize]="15"
		showFirstLastButtons
		aria-label="Select page of periodic elements">
	</mat-paginator>
</div>
