<div class="mat-elevation-z4 transaction-table data-table" data-augmented-ui="tr-2-clip-x br-clip bl-clip-x both">
	<table mat-table
		[dataSource]="dataSource"
		multiTemplateDataRows

	>
		<ng-container matColumnDef="amount">
			<th mat-header-cell

				*matHeaderCellDef> Částka
			</th>
			<td mat-cell
				*matCellDef="let row"> {{row.amount}} Kč
			</td>

		</ng-container>

		<ng-container matColumnDef="type">
			<th mat-header-cell

				*matHeaderCellDef> Typ
			</th>
			<td mat-cell
				*matCellDef="let row">
				<ng-container *ngIf="row.type === 'Payment'">Platba</ng-container>
				<ng-container *ngIf="row.type === 'Deposit'">Vklad</ng-container>
			</td>

		</ng-container>

		<ng-container matColumnDef="created">
			<th mat-header-cell

				*matHeaderCellDef> Vytvořeno
			</th>
			<td mat-cell
				*matCellDef="let row"> {{row.created | date: 'dd/MM/yyyy HH:mm'}} </td>
		</ng-container>

		<ng-container matColumnDef="actions">
			<th mat-header-cell
				*matHeaderCellDef></th>
			<td mat-cell
				[align]="'right'"
				*matCellDef="let row"
			>
				<button (click)="stornoTransaction(row.id)"
					mat-raised-button
					color="warn"
				>Stornovat</button>
			</td>
		</ng-container>

		<ng-container matColumnDef="expandedDetail">
			<td mat-cell
				*matCellDef="let row"
				[attr.colspan]="displayedColumns.length">
				<div class="element-detail"
					[@detailExpand]="row === expandedRow ? 'expanded' : 'collapsed'"
				>
					<div class="detail-content">
						<ng-container *ngIf="detailReady">
							<span>Uživatel: {{ row.userName ?? '' }}</span>
							<br>
							<h3 class="mb-1">Položky</h3>
							<div class="records">
								<div class="record" *ngFor="let record of transactionRecordsMap[row.id]">
									<span class="me-3">{{ goodsMap[record.goodsId].name }}</span>
									<span class="text-right">{{ goodsMap[record.goodsId].price }} Kč</span>
								</div>
							</div>
						</ng-container>
					</div>
				</div>
			</td>
		</ng-container>

		<tr mat-header-row
			*matHeaderRowDef="displayedColumns"></tr>

		<tr mat-row
			*matRowDef="let row; columns: displayedColumns;"
			class="table-row"
			[class.expanded-row]="expandedRow === row"
			(click)="showDetail(row)"
		></tr>

		<tr mat-row
			*matRowDef="let row; columns: ['expandedDetail']"
			class="detail-row">
		</tr>
	</table>
	<mat-paginator [pageSizeOptions]="[5, 10, 15, 25, 100]"
		[pageSize]="15"
		showFirstLastButtons
		aria-label="Select page of periodic elements">
	</mat-paginator>
</div>

<div class="chart-wrapper">
	<div class="chart">
		<canvas baseChart
			[data]="pieChartData"
			[type]="pieChartType"
			[options]="pieChartOptions"
			[plugins]="pieChartPlugins">
		</canvas>
	</div>
</div>
